CREATE PROCEDURE SP_TROCACOLIGADA @OLD VARCHAR (5), @NEW VARCHAR (5) AS
DECLARE @TAB VARCHAR (40)
DECLARE @CAMPO VARCHAR (40)
DECLARE VALOR  SCROLL CURSOR
FOR
SELECT S1.NAME,S2.NAME 
FROM SYSOBJECTS S1,SYSCOLUMNS S2
WHERE S1.TYPE='U' AND S1.ID=S2.ID AND S2.NAME LIKE 'CODCOL%' 
ORDER BY S1.NAME
OPEN VALOR 
FETCH  NEXT FROM VALOR INTO @TAB,@CAMPO
WHILE (@@FETCH_STATUS=0)
BEGIN
  PRINT @TAB
  EXEC ('UPDATE ' +@TAB + ' SET ' + @CAMPO + '=' +@NEW +'WHERE ' + @CAMPO + '='+@OLD )
  PRINT ( '-----------------------//-------------------')
 FETCH  NEXT FROM VALOR INTO @TAB,@CAMPO
END
CLOSE VALOR    
DEALLOCATE VALOR  